import torch

from vit_prisma.utils.constants import DEVICE, MODEL_CHECKPOINTS_DIR
from vit_prisma.configs.HookedViTConfig import HookedViTConfig

IMAGENET100_VIT_CONFIG_FAST = HookedViTConfig(
    n_layers=8,
    d_model=384,
    d_head=48,
    n_heads=8,
    d_mlp=1536,
    model_name="imagenet100-clean-fast",
    activation_name="gelu",
    d_vocab=-1,
    eps=1e-06,
    device=DEVICE,
    initializer_range=0.02,
    init_weights=True,
    dtype=torch.float32,
    rotary_base=10000,
    n_channels=3,
    patch_size=32,
    image_size=224,
    classification_type="cls",
    n_classes=100,
    return_type="class_logits",
    use_wandb=True,
    wandb_team_name="Stevinson",
    wandb_project_name="imagenet100",
    lr=3e-3,
    weight_decay=1e-2,
    loss_fn_name="CrossEntropy",
    batch_size=256,
    warmup_steps=1000,
    scheduler_step=500,
    scheduler_gamma=0.9,
    num_epochs=50,
    save_dir=str(MODEL_CHECKPOINTS_DIR / "imagenet100-fast/clean"),
    save_checkpoints=True,
    save_cp_frequency=2000,
    log_frequency=100,
    layer_norm_pre=True,
    post_embedding_ln=True,
    normalization_type="LN",
    attn_dropout_rate=0.05,
    mlp_dropout_rate=0.05,
    scheduler_type="CosineAnnealing",
)

IMAGENET100_VIT_CONFIG = HookedViTConfig(
    n_layers=10,
    d_model=768,
    d_head=64,
    n_heads=12,
    d_mlp=3072,
    model_name="tinyimagenet_clean",
    activation_name="gelu",
    d_vocab=-1,
    eps=1e-06,
    device=DEVICE,
    initializer_range=0.02,
    init_weights=True,
    dtype=torch.float32,
    rotary_base=10000,
    n_channels=3,
    patch_size=16,
    image_size=128,
    classification_type="cls",
    n_classes=200,
    return_type="class_logits",
    use_wandb=True,
    wandb_team_name="Stevinson",
    wandb_project_name="tinyimagenet",
    lr=1e-3,
    weight_decay=5e-3,
    loss_fn_name="CrossEntropy",
    batch_size=256,
    warmup_steps=7000,
    scheduler_step=1000,
    scheduler_gamma=0.9,
    num_epochs=75,
    save_dir=str(MODEL_CHECKPOINTS_DIR / "tinyimagenet/clean"),
    save_checkpoints=True,
    save_cp_frequency=1000,
    log_frequency=50,
    layer_norm_pre=True,
    post_embedding_ln=True,
    normalization_type="LN",
    attn_dropout_rate=0.1,
    mlp_dropout_rate=0.1,
    scheduler_type="CosineAnnealing",
)