import torch

from vit_prisma.configs.HookedViTConfig import HookedViTConfig
from vit_prisma.utils.constants import DEVICE, MODEL_CHECKPOINTS_DIR

MNIST_CONFIG = HookedViTConfig(
    n_layers=4,
    d_model=64,
    d_head=16,
    n_heads=4,
    d_mlp=256,
    model_name="mnist-clean-64-16-4-256",
    # d_model=128,
    # d_head=32,
    # n_heads=4,
    # d_mlp=512,
    # model_name="mnist-clean-128-32-4-512",
    activation_name="gelu",
    d_vocab=-1,
    eps=1e-06,
    device=DEVICE,
    initializer_range=0.02,
    init_weights=True,
    dtype=torch.float32,
    rotary_base=10000,
    n_channels=1,
    patch_size=16,
    image_size=128,
    classification_type="cls",
    n_classes=10,
    return_type="class_logits",
    use_wandb=True,
    wandb_team_name="Stevinson",
    wandb_project_name="mnist",
    lr=5e-3,
    weight_decay=0.01,
    loss_fn_name="CrossEntropy",
    batch_size=1024,
    warmup_steps=200,
    scheduler_step=500,
    scheduler_gamma=0.9,
    num_epochs=50,
    save_dir=str(MODEL_CHECKPOINTS_DIR / "mnist/clean"),
    save_checkpoints=True,
    save_cp_frequency=25,
    log_frequency=10,
    layer_norm_pre=True,
    post_embedding_ln=True,
    normalization_type=None,
    attn_dropout_rate=0.1,
    mlp_dropout_rate=0.1,
    scheduler_type="CosineAnnealing",
    attack_method=None,
)
# NB. Number of steps is epochs * train images / batch
