import torch
from vit_prisma.configs.HookedViTConfig import HookedViTConfig
from vit_prisma.utils.constants import DEVICE, MODEL_CHECKPOINTS_DIR

CIFAR100_CONIG = HookedViTConfig(
    n_layers=8,
    d_model=384,
    d_head=64,
    n_heads=6,
    d_mlp=1536,
    model_name="cifar100-clean",
    activation_name="gelu",
    d_vocab=-1,
    eps=1e-06,
    device=DEVICE,
    initializer_range=0.02,
    init_weights=True,
    dtype=torch.float32,
    rotary_base=10000,
    n_channels=3,
    patch_size=16,
    image_size=128,
    classification_type="cls",
    n_classes=100,
    return_type="class_logits",
    use_wandb=True,
    wandb_team_name="Stevinson",
    wandb_project_name="cifar100",
    lr=5e-4,
    weight_decay=0.01,
    loss_fn_name="CrossEntropy",
    batch_size=256,
    warmup_steps=1000,
    scheduler_step=1000,
    scheduler_gamma=0.9,
    num_epochs=300,
    save_dir=str(MODEL_CHECKPOINTS_DIR / "cifar100-clean"),
    save_checkpoints=True,
    save_cp_frequency=1000,
    log_frequency=50,
    layer_norm_pre=True,
    post_embedding_ln=True,
    normalization_type="LN",
    attn_dropout_rate=0.05,
    mlp_dropout_rate=0.05,
    scheduler_type="CosineAnnealing",
)